<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.1">
<link rel="alternate" type="application/rss+xml" href="/xlib/blog/rss.xml" title="XLibrary Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/xlib/blog/atom.xml" title="XLibrary Blog Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">Optimization | XLibrary</title><meta data-react-helmet="true" property="og:url" content="https://taburis.github.io/xlib/Machine Learning/Optimization/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Optimization | XLibrary"><meta data-react-helmet="true" name="description" content="Given a system formulated by a function $\mathcal(\boldsymbol{\theta})$, the optimization is to find a point $\boldsymbol{\hat\theta}$ that maximize or minimize the function $\mathcal{L}(\boldsymbol{\theta})$."><meta data-react-helmet="true" property="og:description" content="Given a system formulated by a function $\mathcal(\boldsymbol{\theta})$, the optimization is to find a point $\boldsymbol{\hat\theta}$ that maximize or minimize the function $\mathcal{L}(\boldsymbol{\theta})$."><link data-react-helmet="true" rel="shortcut icon" href="/xlib/img/Ton618_icon.png"><link data-react-helmet="true" rel="canonical" href="https://taburis.github.io/xlib/Machine Learning/Optimization/"><link data-react-helmet="true" rel="alternate" href="https://taburis.github.io/xlib/Machine Learning/Optimization/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://taburis.github.io/xlib/Machine Learning/Optimization/" hreflang="x-default"><link rel="stylesheet" href="/xlib/assets/css/styles.0e8eb294.css">
<link rel="preload" href="/xlib/assets/js/runtime~main.46c591e7.js" as="script">
<link rel="preload" href="/xlib/assets/js/main.065248ea.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP shadow--md">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/xlib/"><img src="/xlib/img/Ton618.png" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/xlib/img/Ton618.png" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">XLibrary</b></a><a class="navbar__item navbar__link navbar__link--active" href="/xlib/">Notes</a><a class="navbar__item navbar__link" href="/xlib/blog/">Blog</a><a class="navbar__item navbar__link"></a></div><div class="navbar__items navbar__items--right"><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/xlib/"><img src="/xlib/img/Ton618.png" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/xlib/img/Ton618.png" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">XLibrary</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/xlib/">Notes</a></li><li class="menu__list-item"><a class="menu__link" href="/xlib/blog/">Blog</a></li><li class="menu__list-item"><a class="menu__link"></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/xlib/">Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Algorithm</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/xlib/Algorithm/Tree-Traversal/">Tree Traversal</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Machine Learning</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/xlib/Machine Learning/Deep-Reinforcement-Learning/">Deep Reinforcement Learning</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/xlib/Machine Learning/Neural-Network-Architectures/">Neural Network Architectures</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/xlib/Machine Learning/Optimization/">Optimization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/xlib/Machine Learning/Regularization/">Regularization</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Math</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/xlib/Math/Generalized-Inverse/">Generalized Inverse</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/xlib/Math/Lebesgue-Integral/">Lebesgue Integral</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/xlib/Math/Manifold/">Manifold</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/xlib/Math/Set/">Set</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Statistics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/xlib/Statistics/Conditional-Expectation/">Conditional Expectation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/xlib/Statistics/Hidden-Markov-Model/">Hidden Markov Model</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/xlib/Statistics/Ito-Integral/">Ito Integral</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/xlib/Statistics/Kalman-Filter/">Kalman Filter</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/xlib/Statistics/Stochastic-Process/">Stochastic Process</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">Optimization</h1></header><p>Given a system formulated by a function <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">Î¸</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}(\boldsymbol{\theta})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathcal">L</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em">Î¸</span></span></span><span class="mclose">)</span></span></span></span></span>, the optimization is to find a point <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><mover accent="true"><mi mathvariant="bold-italic">Î¸</mi><mo>^</mo></mover></mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\hat\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9578799999999998em;vertical-align:0em"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord boldsymbol" style="margin-right:0.03194em">Î¸</span></span><span style="top:-3.26344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.2875em"><span class="mord mathbf">^</span></span></span></span></span></span></span></span></span></span></span></span></span> that maximize or minimize the function <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">Î¸</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}(\boldsymbol{\theta})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathcal">L</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em">Î¸</span></span></span><span class="mclose">)</span></span></span></span></span>. </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="gradient-searching"></a>Gradient Searching<a class="hash-link" href="#gradient-searching" title="Direct link to heading">#</a></h2><p>One of the most practical solutions is based on the fact that gradient <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">âˆ‡</mi><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\nabla\mathcal{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord">âˆ‡</span><span class="mord"><span class="mord mathcal">L</span></span></span></span></span></span> always pointed to the fast direction that increase the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\mathcal{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord"><span class="mord mathcal">L</span></span></span></span></span></span>, and the gradient is 0 at the maximum or minimum points of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\mathcal{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord"><span class="mord mathcal">L</span></span></span></span></span></span>. The idea of gradient searching can be illustrated by the gradient descent algorithm (searching for minimum point) as an example:</p><ol><li>Start at a random point in parameter space <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">Î¸</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em">Î¸</span></span></span></span></span></span></span></li><li>Update the point following the gradent <div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="bold-italic">Î¸</mi><mo>â†’</mo><mi mathvariant="bold-italic">Î¸</mi><mo>âˆ’</mo><mi>r</mi><mi mathvariant="normal">âˆ‡</mi><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">Î¸</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta} \to \boldsymbol{\theta} - r\nabla\mathcal{L}(\boldsymbol{\theta}),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em">Î¸</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em">Î¸</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mord">âˆ‡</span><span class="mord"><span class="mord mathcal">L</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em">Î¸</span></span></span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span></div>where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span> is a learning rate.</li><li>Repeat the steps above until converge.</li></ol><p>In real practice, despite the cost of calculating the gradient is expensive for each step, but also several points need to be aware:</p><ul><li>The gradient usually comes from a grid difference. It is critical to have a good estimation on the gradient.</li><li>The gradient searching may leads to a stable point that <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">âˆ‡</mi><mi mathvariant="script">L</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\nabla \mathcal{L}=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord">âˆ‡</span><span class="mord"><span class="mord mathcal">L</span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">0</span></span></span></span></span> but it is neither locally maximum nor minimum.</li><li>Choosing the learning rate is subtle task. A larger learning rate may needs fewer iterations to approach the solution, but it is also easier to past the minimum point so that the searching will move around the solution back and forth.</li><li>Converge standard can be tricky, it depends on the precision of the model.</li><li>Training sample may include noise so that the gradient may not precise. </li></ul><p>Based on the idea of gradient searching, a variety of algorithm developed targeting to solve the optimization problem in a more practical way.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="batch-gradient-descent"></a>Batch Gradient Descent<a class="hash-link" href="#batch-gradient-descent" title="Direct link to heading">#</a></h3><p>To suppress the error of the gradient raising from the fluctuation from input samples, the gradient is estimated by the mean of the gradients obtained from each of the input samples. The main purpose of the BGD is to reduce the error of the gradients at a cost of calculating the gradients for every data in the training batch.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="stochastic-gradient-descent"></a>Stochastic Gradient Descent<a class="hash-link" href="#stochastic-gradient-descent" title="Direct link to heading">#</a></h3><p>The stochastic gradient descent (SGD) uses a gradient calculated from a random picked sample form training batch as the estimation for ground truth gradient. The advantage of this method is that it will only calculate the gradient once per each batch (independent on the batch size), it significantly simplified the gradient computation at the cost that the error of the SGD will makes the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\mathcal{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord"><span class="mord mathcal">L</span></span></span></span></span></span> fluctuation during the searching iteration.</p><h3></h3></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/Taburis/xlib/edit/master/docs/Machine Learning/Optimization.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/xlib/Machine Learning/Neural-Network-Architectures/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Neural Network Architectures</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/xlib/Machine Learning/Regularization/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Regularization Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#gradient-searching" class="table-of-contents__link">Gradient Searching</a><ul><li><a href="#batch-gradient-descent" class="table-of-contents__link">Batch Gradient Descent</a></li><li><a href="#stochastic-gradient-descent" class="table-of-contents__link">Stochastic Gradient Descent</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Xiao W. Built with Docusaurus.</div></div></div></footer></div>
<script src="/xlib/assets/js/runtime~main.46c591e7.js"></script>
<script src="/xlib/assets/js/main.065248ea.js"></script>
</body>
</html>